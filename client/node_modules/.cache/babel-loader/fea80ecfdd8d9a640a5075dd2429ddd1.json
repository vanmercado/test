{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _Utilities = require('./Utilities');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n} // helper function for setting row/col-span in pivotTableRenderer\n\n\nvar spanSize = function spanSize(arr, i, j) {\n  var x = void 0;\n\n  if (i !== 0) {\n    var asc = void 0,\n        end = void 0;\n    var noDraw = true;\n\n    for (x = 0, end = j, asc = end >= 0; asc ? x <= end : x >= end; asc ? x++ : x--) {\n      if (arr[i - 1][x] !== arr[i][x]) {\n        noDraw = false;\n      }\n    }\n\n    if (noDraw) {\n      return -1;\n    }\n  }\n\n  var len = 0;\n\n  while (i + len < arr.length) {\n    var asc1 = void 0,\n        end1 = void 0;\n    var stop = false;\n\n    for (x = 0, end1 = j, asc1 = end1 >= 0; asc1 ? x <= end1 : x >= end1; asc1 ? x++ : x--) {\n      if (arr[i][x] !== arr[i + len][x]) {\n        stop = true;\n      }\n    }\n\n    if (stop) {\n      break;\n    }\n\n    len++;\n  }\n\n  return len;\n};\n\nfunction redColorScaleGenerator(values) {\n  var min = Math.min.apply(Math, values);\n  var max = Math.max.apply(Math, values);\n  return function (x) {\n    // eslint-disable-next-line no-magic-numbers\n    var nonRed = 255 - Math.round(255 * (x - min) / (max - min));\n    return {\n      backgroundColor: 'rgb(255,' + nonRed + ',' + nonRed + ')'\n    };\n  };\n}\n\nfunction makeRenderer() {\n  var opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var TableRenderer = function (_React$PureComponent) {\n    _inherits(TableRenderer, _React$PureComponent);\n\n    function TableRenderer() {\n      _classCallCheck(this, TableRenderer);\n\n      return _possibleConstructorReturn(this, (TableRenderer.__proto__ || Object.getPrototypeOf(TableRenderer)).apply(this, arguments));\n    }\n\n    _createClass(TableRenderer, [{\n      key: 'render',\n      value: function render() {\n        var _this2 = this;\n\n        var pivotData = new _Utilities.PivotData(this.props);\n        var colAttrs = pivotData.props.cols;\n        var rowAttrs = pivotData.props.rows;\n        var rowKeys = pivotData.getRowKeys();\n        var colKeys = pivotData.getColKeys();\n        var grandTotalAggregator = pivotData.getAggregator([], []);\n\n        var valueCellColors = function valueCellColors() {};\n\n        var rowTotalColors = function rowTotalColors() {};\n\n        var colTotalColors = function colTotalColors() {};\n\n        if (opts.heatmapMode) {\n          var colorScaleGenerator = this.props.tableColorScaleGenerator;\n          var rowTotalValues = colKeys.map(function (x) {\n            return pivotData.getAggregator([], x).value();\n          });\n          rowTotalColors = colorScaleGenerator(rowTotalValues);\n          var colTotalValues = rowKeys.map(function (x) {\n            return pivotData.getAggregator(x, []).value();\n          });\n          colTotalColors = colorScaleGenerator(colTotalValues);\n\n          if (opts.heatmapMode === 'full') {\n            var allValues = [];\n            rowKeys.map(function (r) {\n              return colKeys.map(function (c) {\n                return allValues.push(pivotData.getAggregator(r, c).value());\n              });\n            });\n            var colorScale = colorScaleGenerator(allValues);\n\n            valueCellColors = function valueCellColors(r, c, v) {\n              return colorScale(v);\n            };\n          } else if (opts.heatmapMode === 'row') {\n            var rowColorScales = {};\n            rowKeys.map(function (r) {\n              var rowValues = colKeys.map(function (x) {\n                return pivotData.getAggregator(r, x).value();\n              });\n              rowColorScales[r] = colorScaleGenerator(rowValues);\n            });\n\n            valueCellColors = function valueCellColors(r, c, v) {\n              return rowColorScales[r](v);\n            };\n          } else if (opts.heatmapMode === 'col') {\n            var colColorScales = {};\n            colKeys.map(function (c) {\n              var colValues = rowKeys.map(function (x) {\n                return pivotData.getAggregator(x, c).value();\n              });\n              colColorScales[c] = colorScaleGenerator(colValues);\n            });\n\n            valueCellColors = function valueCellColors(r, c, v) {\n              return colColorScales[c](v);\n            };\n          }\n        }\n\n        var getClickHandler = this.props.tableOptions && this.props.tableOptions.clickCallback ? function (value, rowValues, colValues) {\n          var filters = {};\n          var _iteratorNormalCompletion = true;\n          var _didIteratorError = false;\n          var _iteratorError = undefined;\n\n          try {\n            for (var _iterator = Object.keys(colAttrs || {})[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n              var i = _step.value;\n              var attr = colAttrs[i];\n\n              if (colValues[i] !== null) {\n                filters[attr] = colValues[i];\n              }\n            }\n          } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion && _iterator.return) {\n                _iterator.return();\n              }\n            } finally {\n              if (_didIteratorError) {\n                throw _iteratorError;\n              }\n            }\n          }\n\n          var _iteratorNormalCompletion2 = true;\n          var _didIteratorError2 = false;\n          var _iteratorError2 = undefined;\n\n          try {\n            for (var _iterator2 = Object.keys(rowAttrs || {})[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n              var _i = _step2.value;\n              var attr = rowAttrs[_i];\n\n              if (rowValues[_i] !== null) {\n                filters[attr] = rowValues[_i];\n              }\n            }\n          } catch (err) {\n            _didIteratorError2 = true;\n            _iteratorError2 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                _iterator2.return();\n              }\n            } finally {\n              if (_didIteratorError2) {\n                throw _iteratorError2;\n              }\n            }\n          }\n\n          return function (e) {\n            return _this2.props.tableOptions.clickCallback(e, value, filters, pivotData);\n          };\n        } : null;\n        return _react2.default.createElement('table', {\n          className: 'pvtTable'\n        }, _react2.default.createElement('thead', null, colAttrs.map(function (c, j) {\n          return _react2.default.createElement('tr', {\n            key: 'colAttr' + j\n          }, j === 0 && rowAttrs.length !== 0 && _react2.default.createElement('th', {\n            colSpan: rowAttrs.length,\n            rowSpan: colAttrs.length\n          }), _react2.default.createElement('th', {\n            className: 'pvtAxisLabel'\n          }, c), colKeys.map(function (colKey, i) {\n            var x = spanSize(colKeys, i, j);\n\n            if (x === -1) {\n              return null;\n            }\n\n            return _react2.default.createElement('th', {\n              className: 'pvtColLabel',\n              key: 'colKey' + i,\n              colSpan: x,\n              rowSpan: j === colAttrs.length - 1 && rowAttrs.length !== 0 ? 2 : 1\n            }, colKey[j]);\n          }), j === 0 && _react2.default.createElement('th', {\n            className: 'pvtTotalLabel',\n            rowSpan: colAttrs.length + (rowAttrs.length === 0 ? 0 : 1)\n          }, 'Totals'));\n        }), rowAttrs.length !== 0 && _react2.default.createElement('tr', null, rowAttrs.map(function (r, i) {\n          return _react2.default.createElement('th', {\n            className: 'pvtAxisLabel',\n            key: 'rowAttr' + i\n          }, r);\n        }), _react2.default.createElement('th', {\n          className: 'pvtTotalLabel'\n        }, colAttrs.length === 0 ? 'Totals' : null))), _react2.default.createElement('tbody', null, rowKeys.map(function (rowKey, i) {\n          var totalAggregator = pivotData.getAggregator(rowKey, []);\n          return _react2.default.createElement('tr', {\n            key: 'rowKeyRow' + i\n          }, rowKey.map(function (txt, j) {\n            var x = spanSize(rowKeys, i, j);\n\n            if (x === -1) {\n              return null;\n            }\n\n            return _react2.default.createElement('th', {\n              key: 'rowKeyLabel' + i + '-' + j,\n              className: 'pvtRowLabel',\n              rowSpan: x,\n              colSpan: j === rowAttrs.length - 1 && colAttrs.length !== 0 ? 2 : 1\n            }, txt);\n          }), colKeys.map(function (colKey, j) {\n            var aggregator = pivotData.getAggregator(rowKey, colKey);\n            return _react2.default.createElement('td', {\n              className: 'pvtVal',\n              key: 'pvtVal' + i + '-' + j,\n              onClick: getClickHandler && getClickHandler(aggregator.value(), rowKey, colKey),\n              style: valueCellColors(rowKey, colKey, aggregator.value())\n            }, aggregator.format(aggregator.value()));\n          }), _react2.default.createElement('td', {\n            className: 'pvtTotal',\n            onClick: getClickHandler && getClickHandler(totalAggregator.value(), rowKey, [null]),\n            style: colTotalColors(totalAggregator.value())\n          }, totalAggregator.format(totalAggregator.value())));\n        }), _react2.default.createElement('tr', null, _react2.default.createElement('th', {\n          className: 'pvtTotalLabel',\n          colSpan: rowAttrs.length + (colAttrs.length === 0 ? 0 : 1)\n        }, 'Totals'), colKeys.map(function (colKey, i) {\n          var totalAggregator = pivotData.getAggregator([], colKey);\n          return _react2.default.createElement('td', {\n            className: 'pvtTotal',\n            key: 'total' + i,\n            onClick: getClickHandler && getClickHandler(totalAggregator.value(), [null], colKey),\n            style: rowTotalColors(totalAggregator.value())\n          }, totalAggregator.format(totalAggregator.value()));\n        }), _react2.default.createElement('td', {\n          onClick: getClickHandler && getClickHandler(grandTotalAggregator.value(), [null], [null]),\n          className: 'pvtGrandTotal'\n        }, grandTotalAggregator.format(grandTotalAggregator.value())))));\n      }\n    }]);\n\n    return TableRenderer;\n  }(_react2.default.PureComponent);\n\n  TableRenderer.defaultProps = _Utilities.PivotData.defaultProps;\n  TableRenderer.propTypes = _Utilities.PivotData.propTypes;\n  TableRenderer.defaultProps.tableColorScaleGenerator = redColorScaleGenerator;\n  TableRenderer.defaultProps.tableOptions = {};\n  TableRenderer.propTypes.tableColorScaleGenerator = _propTypes2.default.func;\n  TableRenderer.propTypes.tableOptions = _propTypes2.default.object;\n  return TableRenderer;\n}\n\nvar TSVExportRenderer = function (_React$PureComponent2) {\n  _inherits(TSVExportRenderer, _React$PureComponent2);\n\n  function TSVExportRenderer() {\n    _classCallCheck(this, TSVExportRenderer);\n\n    return _possibleConstructorReturn(this, (TSVExportRenderer.__proto__ || Object.getPrototypeOf(TSVExportRenderer)).apply(this, arguments));\n  }\n\n  _createClass(TSVExportRenderer, [{\n    key: 'render',\n    value: function render() {\n      var pivotData = new _Utilities.PivotData(this.props);\n      var rowKeys = pivotData.getRowKeys();\n      var colKeys = pivotData.getColKeys();\n\n      if (rowKeys.length === 0) {\n        rowKeys.push([]);\n      }\n\n      if (colKeys.length === 0) {\n        colKeys.push([]);\n      }\n\n      var headerRow = pivotData.props.rows.map(function (r) {\n        return r;\n      });\n\n      if (colKeys.length === 1 && colKeys[0].length === 0) {\n        headerRow.push(this.props.aggregatorName);\n      } else {\n        colKeys.map(function (c) {\n          return headerRow.push(c.join('-'));\n        });\n      }\n\n      var result = rowKeys.map(function (r) {\n        var row = r.map(function (x) {\n          return x;\n        });\n        colKeys.map(function (c) {\n          var v = pivotData.getAggregator(r, c).value();\n          row.push(v ? v : '');\n        });\n        return row;\n      });\n      result.unshift(headerRow);\n      return _react2.default.createElement('textarea', {\n        value: result.map(function (r) {\n          return r.join('\\t');\n        }).join('\\n'),\n        style: {\n          width: window.innerWidth / 2,\n          height: window.innerHeight / 2\n        },\n        readOnly: true\n      });\n    }\n  }]);\n\n  return TSVExportRenderer;\n}(_react2.default.PureComponent);\n\nTSVExportRenderer.defaultProps = _Utilities.PivotData.defaultProps;\nTSVExportRenderer.propTypes = _Utilities.PivotData.propTypes;\nexports.default = {\n  Table: makeRenderer(),\n  'Table Heatmap': makeRenderer({\n    heatmapMode: 'full'\n  }),\n  'Table Col Heatmap': makeRenderer({\n    heatmapMode: 'col'\n  }),\n  'Table Row Heatmap': makeRenderer({\n    heatmapMode: 'row'\n  }),\n  'Exportable TSV': TSVExportRenderer\n};\nmodule.exports = exports['default'];","map":{"version":3,"sources":["src/TableRenderers.jsx"],"names":["spanSize","x","i","asc","end","noDraw","arr","len","asc1","end1","stop","min","Math","max","nonRed","backgroundColor","opts","TableRenderer","React","pivotData","PivotData","colAttrs","rowAttrs","rowKeys","colKeys","grandTotalAggregator","valueCellColors","rowTotalColors","colTotalColors","colorScaleGenerator","rowTotalValues","colTotalValues","allValues","colorScale","rowColorScales","rowValues","colColorScales","colValues","getClickHandler","filters","Object","attr","j","c","colKey","r","totalAggregator","rowKey","txt","aggregator","PropTypes","TSVExportRenderer","PureComponent","headerRow","result","row","v","width","window","height","Table","makeRenderer","heatmapMode"],"mappings":"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","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport {PivotData} from './Utilities';\n\n// helper function for setting row/col-span in pivotTableRenderer\nconst spanSize = function(arr, i, j) {\n  let x;\n  if (i !== 0) {\n    let asc, end;\n    let noDraw = true;\n    for (\n      x = 0, end = j, asc = end >= 0;\n      asc ? x <= end : x >= end;\n      asc ? x++ : x--\n    ) {\n      if (arr[i - 1][x] !== arr[i][x]) {\n        noDraw = false;\n      }\n    }\n    if (noDraw) {\n      return -1;\n    }\n  }\n  let len = 0;\n  while (i + len < arr.length) {\n    let asc1, end1;\n    let stop = false;\n    for (\n      x = 0, end1 = j, asc1 = end1 >= 0;\n      asc1 ? x <= end1 : x >= end1;\n      asc1 ? x++ : x--\n    ) {\n      if (arr[i][x] !== arr[i + len][x]) {\n        stop = true;\n      }\n    }\n    if (stop) {\n      break;\n    }\n    len++;\n  }\n  return len;\n};\n\nfunction redColorScaleGenerator(values) {\n  const min = Math.min.apply(Math, values);\n  const max = Math.max.apply(Math, values);\n  return x => {\n    // eslint-disable-next-line no-magic-numbers\n    const nonRed = 255 - Math.round((255 * (x - min)) / (max - min));\n    return {backgroundColor: `rgb(255,${nonRed},${nonRed})`};\n  };\n}\n\nfunction makeRenderer(opts = {}) {\n  class TableRenderer extends React.PureComponent {\n    render() {\n      const pivotData = new PivotData(this.props);\n      const colAttrs = pivotData.props.cols;\n      const rowAttrs = pivotData.props.rows;\n      const rowKeys = pivotData.getRowKeys();\n      const colKeys = pivotData.getColKeys();\n      const grandTotalAggregator = pivotData.getAggregator([], []);\n\n      let valueCellColors = () => {};\n      let rowTotalColors = () => {};\n      let colTotalColors = () => {};\n      if (opts.heatmapMode) {\n        const colorScaleGenerator = this.props.tableColorScaleGenerator;\n        const rowTotalValues = colKeys.map(x =>\n          pivotData.getAggregator([], x).value()\n        );\n        rowTotalColors = colorScaleGenerator(rowTotalValues);\n        const colTotalValues = rowKeys.map(x =>\n          pivotData.getAggregator(x, []).value()\n        );\n        colTotalColors = colorScaleGenerator(colTotalValues);\n\n        if (opts.heatmapMode === 'full') {\n          const allValues = [];\n          rowKeys.map(r =>\n            colKeys.map(c =>\n              allValues.push(pivotData.getAggregator(r, c).value())\n            )\n          );\n          const colorScale = colorScaleGenerator(allValues);\n          valueCellColors = (r, c, v) => colorScale(v);\n        } else if (opts.heatmapMode === 'row') {\n          const rowColorScales = {};\n          rowKeys.map(r => {\n            const rowValues = colKeys.map(x =>\n              pivotData.getAggregator(r, x).value()\n            );\n            rowColorScales[r] = colorScaleGenerator(rowValues);\n          });\n          valueCellColors = (r, c, v) => rowColorScales[r](v);\n        } else if (opts.heatmapMode === 'col') {\n          const colColorScales = {};\n          colKeys.map(c => {\n            const colValues = rowKeys.map(x =>\n              pivotData.getAggregator(x, c).value()\n            );\n            colColorScales[c] = colorScaleGenerator(colValues);\n          });\n          valueCellColors = (r, c, v) => colColorScales[c](v);\n        }\n      }\n\n      const getClickHandler =\n        this.props.tableOptions && this.props.tableOptions.clickCallback\n          ? (value, rowValues, colValues) => {\n              const filters = {};\n              for (const i of Object.keys(colAttrs || {})) {\n                const attr = colAttrs[i];\n                if (colValues[i] !== null) {\n                  filters[attr] = colValues[i];\n                }\n              }\n              for (const i of Object.keys(rowAttrs || {})) {\n                const attr = rowAttrs[i];\n                if (rowValues[i] !== null) {\n                  filters[attr] = rowValues[i];\n                }\n              }\n              return e =>\n                this.props.tableOptions.clickCallback(\n                  e,\n                  value,\n                  filters,\n                  pivotData\n                );\n            }\n          : null;\n\n      return (\n        <table className=\"pvtTable\">\n          <thead>\n            {colAttrs.map(function(c, j) {\n              return (\n                <tr key={`colAttr${j}`}>\n                  {j === 0 && rowAttrs.length !== 0 && (\n                    <th colSpan={rowAttrs.length} rowSpan={colAttrs.length} />\n                  )}\n                  <th className=\"pvtAxisLabel\">{c}</th>\n                  {colKeys.map(function(colKey, i) {\n                    const x = spanSize(colKeys, i, j);\n                    if (x === -1) {\n                      return null;\n                    }\n                    return (\n                      <th\n                        className=\"pvtColLabel\"\n                        key={`colKey${i}`}\n                        colSpan={x}\n                        rowSpan={\n                          j === colAttrs.length - 1 && rowAttrs.length !== 0\n                            ? 2\n                            : 1\n                        }\n                      >\n                        {colKey[j]}\n                      </th>\n                    );\n                  })}\n\n                  {j === 0 && (\n                    <th\n                      className=\"pvtTotalLabel\"\n                      rowSpan={\n                        colAttrs.length + (rowAttrs.length === 0 ? 0 : 1)\n                      }\n                    >\n                      Totals\n                    </th>\n                  )}\n                </tr>\n              );\n            })}\n\n            {rowAttrs.length !== 0 && (\n              <tr>\n                {rowAttrs.map(function(r, i) {\n                  return (\n                    <th className=\"pvtAxisLabel\" key={`rowAttr${i}`}>\n                      {r}\n                    </th>\n                  );\n                })}\n                <th className=\"pvtTotalLabel\">\n                  {colAttrs.length === 0 ? 'Totals' : null}\n                </th>\n              </tr>\n            )}\n          </thead>\n\n          <tbody>\n            {rowKeys.map(function(rowKey, i) {\n              const totalAggregator = pivotData.getAggregator(rowKey, []);\n              return (\n                <tr key={`rowKeyRow${i}`}>\n                  {rowKey.map(function(txt, j) {\n                    const x = spanSize(rowKeys, i, j);\n                    if (x === -1) {\n                      return null;\n                    }\n                    return (\n                      <th\n                        key={`rowKeyLabel${i}-${j}`}\n                        className=\"pvtRowLabel\"\n                        rowSpan={x}\n                        colSpan={\n                          j === rowAttrs.length - 1 && colAttrs.length !== 0\n                            ? 2\n                            : 1\n                        }\n                      >\n                        {txt}\n                      </th>\n                    );\n                  })}\n                  {colKeys.map(function(colKey, j) {\n                    const aggregator = pivotData.getAggregator(rowKey, colKey);\n                    return (\n                      <td\n                        className=\"pvtVal\"\n                        key={`pvtVal${i}-${j}`}\n                        onClick={\n                          getClickHandler &&\n                          getClickHandler(aggregator.value(), rowKey, colKey)\n                        }\n                        style={valueCellColors(\n                          rowKey,\n                          colKey,\n                          aggregator.value()\n                        )}\n                      >\n                        {aggregator.format(aggregator.value())}\n                      </td>\n                    );\n                  })}\n                  <td\n                    className=\"pvtTotal\"\n                    onClick={\n                      getClickHandler &&\n                      getClickHandler(totalAggregator.value(), rowKey, [null])\n                    }\n                    style={colTotalColors(totalAggregator.value())}\n                  >\n                    {totalAggregator.format(totalAggregator.value())}\n                  </td>\n                </tr>\n              );\n            })}\n\n            <tr>\n              <th\n                className=\"pvtTotalLabel\"\n                colSpan={rowAttrs.length + (colAttrs.length === 0 ? 0 : 1)}\n              >\n                Totals\n              </th>\n\n              {colKeys.map(function(colKey, i) {\n                const totalAggregator = pivotData.getAggregator([], colKey);\n                return (\n                  <td\n                    className=\"pvtTotal\"\n                    key={`total${i}`}\n                    onClick={\n                      getClickHandler &&\n                      getClickHandler(totalAggregator.value(), [null], colKey)\n                    }\n                    style={rowTotalColors(totalAggregator.value())}\n                  >\n                    {totalAggregator.format(totalAggregator.value())}\n                  </td>\n                );\n              })}\n\n              <td\n                onClick={\n                  getClickHandler &&\n                  getClickHandler(grandTotalAggregator.value(), [null], [null])\n                }\n                className=\"pvtGrandTotal\"\n              >\n                {grandTotalAggregator.format(grandTotalAggregator.value())}\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      );\n    }\n  }\n\n  TableRenderer.defaultProps = PivotData.defaultProps;\n  TableRenderer.propTypes = PivotData.propTypes;\n  TableRenderer.defaultProps.tableColorScaleGenerator = redColorScaleGenerator;\n  TableRenderer.defaultProps.tableOptions = {};\n  TableRenderer.propTypes.tableColorScaleGenerator = PropTypes.func;\n  TableRenderer.propTypes.tableOptions = PropTypes.object;\n  return TableRenderer;\n}\n\nclass TSVExportRenderer extends React.PureComponent {\n  render() {\n    const pivotData = new PivotData(this.props);\n    const rowKeys = pivotData.getRowKeys();\n    const colKeys = pivotData.getColKeys();\n    if (rowKeys.length === 0) {\n      rowKeys.push([]);\n    }\n    if (colKeys.length === 0) {\n      colKeys.push([]);\n    }\n\n    const headerRow = pivotData.props.rows.map(r => r);\n    if (colKeys.length === 1 && colKeys[0].length === 0) {\n      headerRow.push(this.props.aggregatorName);\n    } else {\n      colKeys.map(c => headerRow.push(c.join('-')));\n    }\n\n    const result = rowKeys.map(r => {\n      const row = r.map(x => x);\n      colKeys.map(c => {\n        const v = pivotData.getAggregator(r, c).value();\n        row.push(v ? v : '');\n      });\n      return row;\n    });\n\n    result.unshift(headerRow);\n\n    return (\n      <textarea\n        value={result.map(r => r.join('\\t')).join('\\n')}\n        style={{width: window.innerWidth / 2, height: window.innerHeight / 2}}\n        readOnly={true}\n      />\n    );\n  }\n}\n\nTSVExportRenderer.defaultProps = PivotData.defaultProps;\nTSVExportRenderer.propTypes = PivotData.propTypes;\n\nexport default {\n  Table: makeRenderer(),\n  'Table Heatmap': makeRenderer({heatmapMode: 'full'}),\n  'Table Col Heatmap': makeRenderer({heatmapMode: 'col'}),\n  'Table Row Heatmap': makeRenderer({heatmapMode: 'row'}),\n  'Exportable TSV': TSVExportRenderer,\n};\n"]},"metadata":{},"sourceType":"script"}